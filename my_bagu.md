- [二、 __计算机网络基础__](#二-计算机网络基础)
  - [1、 __计算机体系模型__](#1-计算机体系模型)
    - [1.1 各层模型](#11-各层模型)
    - [1.2 协议](#12-协议)
      - [1.2.1 常见协议](#121-常见协议)
      - [UDP协议](#udp协议)
      - [__TCP协议__](#tcp协议)
      - [__IP协议__](#ip协议)
      - [以太网帧协议](#以太网帧协议)
      - [ARP协议-地址解析协议](#arp协议-地址解析协议)
    - [__封装__](#封装)
    - [__分用（解封装）__](#分用解封装)
    - [__socket(套接字)__](#socket套接字)
      - [__字节序__](#字节序)
      - [字节序转换函数](#字节序转换函数)


# 二、 __计算机网络基础__
## 1、 __计算机体系模型__
### 1.1 各层模型
- OSI七层模型：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层
- TCP/IP四层模型：网络接口层、网络层、传输层、应用层
- 五层模型：物理层、数据链路层、网络层、传输层、应用层
  ![图 0](images/47ce1eb503708cbc0b03c5953c787596583542f0e5e76c11077d5683daac078b.png)  
### 1.2 协议
#### 1.2.1 常见协议
- __应用层__ 常见协议：
  - DNS、Telnet、SMTP、HTTP、
  - FTP (File Transfer Protocol 文件传输协议)
- __传输层__ 常见协议：
  - TCP (Transmission control Protocol 传输控制协议)
  - UDP (user datagram Protocol 用户数据报协议)
- __网络层__ 常见协议：IP (Internet Protocol 因特网互联协议)
  - ICMP、ARP、RARP、OSPF、IPX、RIP、IGRP

#### UDP协议
![图 1](images/d984fe66808ccf32764aa0f111d2068efed55835ccf6ab7c8cd7f351fed0cba6.png)  
1. 源端口号：发送方端口号
2. 目的端口号：接收方端口号
3. 长度：UDP用户数据报的长度，最小值是8（仅有首部）
4. 校验和：检测UDP用户数据报在传输中是否有错，有错就丢弃

#### __TCP协议__
![![图 2](images/1c51e663109531ba346f3bf5dd07830e5f700a387b118eb5c980f22119a0590b.png)   1](images/3853135e886ef8cc56bee5269f5ddcdad928226ddd337bf369bf9868b84eb84d.png)  

1. 源端口号：发送方端口号
2. 目的端口号：接收方端口号
3. 六个控制位：
   1. URG
   2. ACK
   3. PSH
   4. RST

#### __IP协议__
![图 4](images/5d70d9e89e763b5aba56f1e7b750fc2591191e457b8973e7263c93ff36109996.png)  

__生存时间TTL__：占8位，表明IP数据报文在网路中的 __寿命__，每经过一个设备（不管是路由器还是计算机），TTL减一，当TTL=0时，网络设备必须丢弃该报文（它解决的就是，当网络报文找不到终点的时候，避免网络报文在网络中无限的传输，以消耗带宽）
__八位协议__:占8位，表明IP数据所携带的具体数据是什么协议的（如TCP、UDP等，一些协议对应的值，可参考下图）
![图 5](images/6413987f2a0b40d5a495e9b1a4445e1290e97a5bb5069af43b9396741b036172.png)  

#### 以太网帧协议

#### ARP协议-地址解析协议
地址解析协议，即ARP（Address Resolution Protocol），是根据IP地址获取物理地址的一个TCP/IP协议。
- IP寻址的过程（ARP协议工作）
  - Ip寻址的工作原理
  - 本地网络寻址
- ARP数据包-28个字节
![图 7](images/bb3af7d06537090171c9092cc448cb8708d55e3119dd51d18a01f91a7b2fcea4.png)  
1. 硬件类型：1表示mac地址
2. 协议类型：0X800表示IP协议
3. 硬件地址长度：1个字节，对于以太网的值为6
4. 协议地址长度：4
5. 操作码：1表示ARP请求，2表示ARP应答
6. __目的逻辑地址__：这是一个可变长度字段，用来定义目标的逻辑 __（IP）__ 地址，对于IPv4协议这个字段的长度为4个字节。

以太网帧头：14个字节
帧总长度 = 帧头 + ARP包头 = 14 + 28 = 42 bytes；  
而真正 发包的时为了保证以太网帧的最小帧长为64 bytes，会在报文里添加一个padding字段，用来填充数据包大小。
报文总长度：64个字节

### __封装__
上层协议是如何使用下层协议提供的服务的呢？是通过封装实现的。应用程序数据在发送到物理网络上之前，将沿着协议栈从上往下依次传递。每层协议都将在上层数据的基础上加上自己的头部信息，以实现该层的功能，这个过程就称为封装。

### __分用（解封装）__
![图 6](images/f1763675283e8eda83abc577a7230000cf3465ff686d7baf31e3b8ed27ddd0c5.png)  

### __socket(套接字)__
所谓socket，就是对网络中不同主机上的应用进程之间进行双向通信的端点的抽象，一个套接字就是网络上的进程通信的一端，提供了应用层进程利用网络协议交换数据的机制
- socket是由IP地址和端口结合的，提供向应用层进程传送数据包的机制
- 套接字通信分两部分：（类似插座）
  - 服务器端：被动接受连接，一般不会主动发起连接
  - 客户端：主动向服务器发起连接

#### __字节序__
字节序，顾名思义字节的顺序，就是大于一个字节类型的数据在内存中的存放顺序（一个字节的数据当然就无需谈顺序的问题了）
- 大端字节序
![图 8](images/3e5ecc3583f9cb1397ae81e06f70b75143018e7f20d2af5aa8e6cbd75ea6b286.png)  
~~~
h   - host 主机，主机字节序
to  - 转换成什么
n   - network 网络字节序
s   - short——转换端口
l   - long——转换IP
~~~


- 小端字节序

#### 字节序转换函数
- __网络字节顺序__ 是TCP/IP中规定好的一种数据表示格式，采用大端排序方式
~~~c
unsigned short ntohs(unsigned short);  //将16位的网络字节序转换为主机字节序
unsigned long ntohl(unsigned long);    //将32位的网络字节序转换为主机字节序
unsigned short htons(unsigned short ); //将16位的主机字节序转换为网络字节序
unsigned long  htonl (unsigned long);  //将32位的主机字节序转换为网络字节序
~~~